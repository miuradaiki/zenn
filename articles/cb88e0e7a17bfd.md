---
title: "[AWS Summit Japan 2024 現地レポ]プロンプトエンジニアリングのコツを拾ってきた"
emoji: "🥷"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["AWS", "Tech", "event", "Idea"]
published: false
---

# はじめに

早速ですが、大切な情報なのでシェアさせてください。
**2024年7月5日(金)まで**100 以上のセッションがオンデマンド配信中です！📺
（※ 無料登録が必要です）

セッションの動画・資料がアップロードされていますので、
気になるセッションがあったけど見れかなかった方はお早めに・・・！

https://aws.amazon.com/jp/summits/japan/

# 当日の動き

当日の動きを含めて現地レポートをご紹介します。
まずはざっくりとした当日の動きです。

- 9:00　海浜幕張駅到着☔️
- 9:20　会場入場（※まだブースなどは関係者以外入れないためひたすら待機）
- 10:00〜11:30　基調講演
- 11:50〜12:30　セッション
- 〜14:00　お昼休憩をしつつ各ブース徘徊🚶

（午後から私用があり半日ほどの滞在でした。。）

# 全体的な所感

- やはりAI関連のトピックが熱い🔥
  - 基調講演でもAIのトピックがメイン
    - JRリニアでの活用事例、電通（[ムゲンエーアイ](https://www.dentsudigital.co.jp/news/release/services/2022-12190-000064)）での活用事例
    - [Amazon Bedrock](https://aws.amazon.com/jp/bedrock/)についての話題
- 150以上の多様なセッションがあるが、どれもかなり人気で満席が目立つ
    - なるべく早めの予約が吉です（キャンセルも可能）
    - 私は2日前に参加申し込みしましたが、気になるセッションはことごとく満席でした
    - ただしキャンセルが出る可能性があるので定期的に見にいくと良いです
    - **同じ時間に面白そうなセッションが被ってたりするので、複数人で行って後でシェアするのが賢い戦略**と思われる（オンデマンド配信もあるが期間限定のため）
- Partner Solution Expo（企業の展示ブース）
    - 企業のオリジナルグッズなどがもらえ、活気がありワイワイしているので楽しい！！

### その他現地情報

- 人は多いですが、会場が広いためスムーズに回れます
- トイレだけ結構並んだので要注意です
- 先着でお弁当が無料で貰えます
- 飲み物は不要そうです。基調講演を見に行く時間帯にはペットボトルのドリンクが配られていました。また、お弁当配布時と企業ブースでも貰ったため、自前で持っていくと逆に荷物になるかもしれません
- セッションの間が20分くらいしかないため、予定を詰めすぎると大変です。自分はお昼ご飯のタイミングに困りました


# セッションについて

セッションの種類は大きく分けて以下の3つです。

- 「AWSセッション」：AWSのエキスパートが各種テクノロジーを解説する
- 「パートナーセッション」：AWSのパートナーが技術や取り組みを語る
- 「事例セッション」：AWSの顧客がAWSの導入事例を語る

また「AWSセッション」については難易度に応じてレベル（数字）が割り振られているため、
レベル感を見て受講することをお勧めします
  - Level 100 : 入門者向け
  - Level 200 : 初級者向け
  - Level 300 : 中級者向け
  - Level 400 : 上級者向け

より具体的なレベル感についてはこちらの記事をご覧ください。

https://dev.classmethod.jp/articles/what_is_aws_seminar-level/

# 参加セッション

- 参加セッション：**『大規模言語モデルのプロンプトエンジニアリングのコツ』**
- Level 300（中級者向け）
- 概要：プロンプトエンジニアリングのテクニックを10個紹介。Claude3にフォーカスして解説

全体の[タイムテーブル](https://pages.awscloud.com/rs/112-TZM-766/images/AWS-Summit-2024-Japan_Agenda.pdf)はこちらです。

## セッション内容

まずは紹介されていたテクニックの一覧です。

### テクニック一覧

- 明確かつ直接的に
- XMLタグの利用
- 例示
- 出力形式の指定&Claudeの代弁
- 考える時間を与える
- 役割のアサイン
- ハルシネーションへの対処
- 不適切なユーザー入力への対処
- プロンプトチェーン
- 長い文章でのテクニック

ただし、全てのプロンプトにこれら全ての要素が必要というわけではありません、
まずは高い精度を出せるように要素を増やした後に削っていくのが良いとアプローチだと解説されていました。

良いプロンプトの作成には、**実験と反復**が必要です。


### はじめに1：適切なプロンプトを設計する方法

- 経験の科学：常にプロンプトをテスト、頻繁に反復
- 評価データを作成（エッジケースを忘れずに）⇒準備用のプロンプト⇒評価データでテスト⇒プロンプト修正⇒完成
    - まずプロンプトを作成するのではなく、どういう結果が得られたら成功かという期待値を洗い出してからプロンプトを実行して評価・修正をする

### はじめに2：Claude3のAPIフォーマットについて

- Claude3は”user”（人間の入力）と”assistant”（Claudeの出力）を交互に繰り返す形で対話を進める
- APIリクエストのJSONで `”role”: "user"` と指定して質問する

```json
{
  "role": "user",
  "content": "なぜ空は青いのですか？"
}
```

## 明確かつ直接的に

- Claudeは明確で直接的な指示に最もいい答えを出す
- 明確なプロンプトの黄金律：自分のプロンプトを他人に見せて、求めている結果を相手が出せるか聞いてみる

## XMLタグの利用

- 区切り目がないとClaudeは理解しにくい
    - XMLタグを使うとClaudeがプロンプトの構造を認識しやすくなる

## 例示

- 例はいくつ必要か？（以下2024年6月時点の情報）
    - 最適な例の数に厳しいルールはない
    - 少なくとも3〜5この例を含むことを目指す
    - Claudeの振る舞いが期待通りでない場合は、例を幾つ追加してもいい
- Claude2.0に128個以上の例を与えても精度が向上した実験がある
    - 悪意のある例を増やすと、悪意のある回答が出力される可能性も上がる

## 出力形式の指定&Claudeの代弁

- Claudeに行って欲しいことを正確に言わせる方法
- 出力のフォーマットを指定し、Claudeの代弁として出力の一部を書く

User（入力）：フォーマットを指定

```json
猫についての俳句を書いてください。
"first_line", "second_line", "third_line"
をキーとしてJSONフォーマットを使用してください。
```

Assistant（出力）：代弁として出力を書き始める

```json
{
```

## 考える時間を与える

- 思考過程と回答の出力形式を指定する
    - 例： 答える前に、`<thinking></thinking>` XMLタグ内で質問について考えてください。
- Claudeの論理やプロンプトの不明確さのトラブルシューティングが可能

## 役割のアサイン

- 有名かと思うので割愛
- Claudeに役割を認識させることで回答が変わってくる

## ハルシネーションへの対処

- Claudeがわからない場合に**「知らない」という**許可を与える
- Claudeが自分自身の回答に**自信がある時だけ答える**ように言う
- Claudeに長いドキュメントの中から**適切な引用を見つけて**その引用を使って答えるように頼む

### 不適切なユーザー入力への対処

- Claudeはプロンプトインジェクションや不適切な入力に対して元来体制が高い（らしい）
- 不適切なら応答をブロックするように指示

## プロンプトチェーン

- ステップ数の多いタスクではタスクを分割する

## 長い文章でのテクニック

- 長い（10K〜100Kトークン）プロンプトでは以下を行う
    - 後から質問するとあらかじめ伝える
    - XMLタグで構造化をする
    - 引用を見つけさせる
        - 質問に答える際はまず引用をみつけ、<quote></quote>XMLタグで示してください
    - ~~ドキュメントをもとに例を提示する~~
    - プロンプトの最後で質問をする

# その他サービス・企業紹介

ブースで知った企業の紹介です。

- [Dynatrace](https://www.dynatrace.com/ja/)
    - [Datadog](https://www.datadoghq.com/ja/)の類似サービス
    - 半分近くは金融系で使用されているらしい
    - サービス説明
        - Dynatraceは複雑化したモダンなITシステムを1つのプラットフォームでアプリケーションレベルからインフラレベルまで一気通貫して可視化するユニファイド・オブザーバビリティプラットフォームです。
        - 容易な導入、監視対象の自動認識、AIによる問題原因分析によりIT運用監視を効率化します。
- [classmethod](https://classmethod.jp/)
    - AWSの導入支援等
    - 技術記事でお世話になった方多いかも？
        - [DevelopersIO](https://dev.classmethod.jp/) という技術メディア運営

# 最後に

- 1人では拾える情報が限られるので、来年はぜひ複数人で行きましょう！！
    - セッションやブースが多すぎて全然見切れない、、😭
- でっかいイベント、ただただ楽しい
